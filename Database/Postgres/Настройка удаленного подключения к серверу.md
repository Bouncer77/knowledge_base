# Настройка удаленного подключения к серверу

```sql
# Вывести расположение файла
SHOW config_file;

# /app/pgsql-data/pg_hba.conf
```


# /etc/postgresql/12/main/pg_hba.conf

> Первая запись с соответствующим типом соединения, адресом клиента, указанной базой данных и именем пользователя применяется для аутентификации.
> Если выбрана запись и аутентификация не прошла, последующие записи не рассматриваются.
> Если же ни одна из записей не подошла, в доступе будет отказано.

https://postgrespro.ru/docs/postgresql/9.6/auth-pg-hba-conf

## 7 форматов записи

№  | тип соединения |  имя базы данных | имя пользователя | диапазон IP-адресов клиента  | способ аутентификации
---|----------------|------------------|------------------|------------------------------|------------------------------
1  | local          | база             | пользователь     |                              | метод-аутентификации  [параметры-аутентификации]
2  | host           | база             | пользователь     | адрес                        | метод-аутентификации  [параметры-аутентификации]
3  | hostssl        | база             | пользователь     | адрес                        | метод-аутентификации  [параметры-аутентификации]
4  | hostnossl      | база             | пользователь     | адрес                        | метод-аутентификации  [параметры-аутентификации]
5  | host           | база             | пользователь     | IP-адрес  IP-маска           | метод-аутентификации  [параметры-аутентификации]
6  | hostssl        | база             | пользователь     | IP-адрес  IP-маска           | метод-аутентификации  [параметры-аутентификации]
7  | hostnossl      | база             | пользователь     | IP-адрес  IP-маска           | метод-аутентификации  [параметры-аутентификации]

## Обновить конфигурации

```bash
sudo systemctl restart postgresql@12-main

или

sudo service postgresql restart

# Открыть порт
sudo ufw allow 5432/tcp
```
