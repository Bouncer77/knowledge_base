Pupuska_77

# Конвеер (pipe)

Программа1|Программа2|...|ПрограммаN

Пока программа 1 не выполнилась, то программа 2 не начнет выполнение

# wget

скачать файл по ссылке и сохранить его в текущей директории

```bash
wget -P <путь_до_директории> <ссылка>

wget -O <путь_до_файла> <ссылка>

# Докачать файл по ссылке в случае обрыва связи
wget -c <ссылка>

# Проверить доступность файла по ссылке
wget --spider <ссылка>

# Скачать несколько файлов по ссылкам из текстового файла
wget -i <текстовый_файл>

# Рекурсивное скачивание файлов по ссылке на указанную глубину (по умолчанию глубина 5)
wget -r -l <глубина> <ссылка>

# Определенные типы файлов (другие файлы будут удалены по окончании загрузки)
wget -r -A jpg,png <ссылка>
```

Команда   | Описание
----------|--------------------------------------------------
pwd | Print Working Directory - вывести информацию о рабочей директории
cd | Change Directory - изменить директорию

# Архиваторы

Действие    | zip        | gz или tgz       | bz2
------------|------------|------------------|----------------------------
Распаковать | unzip      | gunzip           | tar -xjvf архив.tar.bz2
Запаковать  | zip ...    | tar -xzvf ...    | tar -cjvf ...

-с - создать архив
-v - подробный вывод в терминал
-f - файл создается в файловой системе, а не на магнитной ленте
-z - сжатие с помощью архиватора gzip
-j - сжатие с помощью архиватора bz2

# Поиск

### Поиск по файлам

find <папка> -name "<имя файла>"

* - ноль или более любых символов
? - один любой символ


### Поиск по содержанию

grep "<строка>" <файл> | найти строку в файле
grep -c "<строка>" <файл> | посчитать количество вхождений строки
grep -r "<строка>" <папка> | найти строку во всех файлах в папке

# Подключение к удаленным серверам

ssh логин@адрес_сервера -p порт

### Вход без пароля

На клиенте | На сервере
-----------|-------------------------
~/.ssh/id_rsa | 
~/.ssh/id_rsa.pub | ~/.ssh/authorized_keys

Команда | Назначение
---------|----------------------------------------------
ssh-keygen | Создание ключа
ssh-add | Сообщить системе о ключе
cat ~/.id_rsa.pub | Просмотр публичного ключа
nano ~/.ssh/authorised_keys | Редактирование авторизованных ключей (на сервере)

### Обмен файлами

Команда | Назначение
--------|-------------------------------------
scp -P порт логин@адрес_сервера:путь_сервер путь_клиент | С сервера
scp -P порт путь_клиент логин@адрес_сервера:путь_сервер | На сервер

### Запуск программ

Команда | Назначение
--------|-------------------------------------
Ctrl + C | Прерывание выполнения
Ctrl + Z | Приостановить выполнение
jobs | Просмотр списка запущенных вами приложений
fg %<номер>| Продолжить (foreground)
bg %<номер>| Продолжить в фоновом режиме (background)
ps | Посмотреть ваши процессы
top | Отслеживать процессы в реальном времени
top -u <имя_пользователя> | Отслеживать процессы этого пользователя
kill <номер процесса> | Завершение процесса 
kill -9 <номер процесса> | Жесткое завершение процесса

ps и top выдают номера PID - которые являются номером процесса


# Установка и удаление программ

Команда | Назначение
--------|-------------------------------------
sudo apt-get install программа | Установка
sudo apy-get remove программа | Удаление
sudo apt-get update | Обновление ссылок на пакеты
sudo apt-get upgrade | Обновление установленных пакетов
sudo apt-get install --only0upgrade программа | Обновить одну программу

# Собрать информацию о компьютере

Команда         | Назначение
----------------|-------------------------------------
free -g         | Информация об оперативной памяти
nproc           | Сколько ядер в процессоре
lscpu           | Детальная информация о процессоре

# tmux

tmux сохраняет всю историю работы на сервере

Если вы закрыли терминал или у вас пропал интернет - tmux сохранит вашу работу на сервере

Команда c графикой | Без графики          | Назначение
-------------------|----------------------|---------------
Ctrl + Shift + T   | tmux -> Ctrl + B , C | Открыть новую вкладку в терминале
-                  | Ctrl + B             | Перейти в режим команд
Alt + <цифра>      | Ctrl + B , <цифра>   | Перейти в указанную вкладку
-                  | Ctrl + B , N / Ctrl + B , P | Перейти в следующую / предыдущую вкладку
Ctrl + Shift + W   | Ctrl + B , X или exit | Закрыть текущую вкладку
- | Ctrl + B , D | Временно выйти из tmux
- | tmux attach / tmux a | Вернуться в tmux
- | tmux list-sessions   | Посмотреть список запущенных tmux-ов

### Разделить одну вкладку на несколько

Для "горизонтального" разделения используется (Ctrl+B и "), а для "вертикального" -- (Ctrl+B и %).

### Просмотр истории в tmux

Команда              | Назначение
---------------------|-------------------------------------
Ctrl + B , PgUp | Перейти в режим просмотра истории
PgUP, PgDown, стрелки | Перемещать курсор по истории
Esc, Ctrl + C | Выйти из режима просмотра истории

# Установка Ubuntu

Полезные для установки Linux (дистрибутив Ubuntu) ссылки:

Сайт Ubuntu: http://www.ubuntu.com/ (есть еще русскоязычная версия http://ubuntu.ru/, но там меньше информации).

Страница скачивания текущей версии: http://www.ubuntu.com/download/desktop, предыдущих версий: http://releases.ubuntu.com/. Нужно выбирать версию Desktop (если конечно у вас не сервер) и соответствующее вашему компьютеру количество разрядов (32-bit или 64-bit).

Информация о том, как записать скачанный .iso файл на установочный диск или флешку, находится на этой странице в разделе "Easy ways to switch to Ubuntu" (нужно выбрать имеющуюся у вас систему и DVD или bootable USB stick).

Подробная инструкция по установке: http://www.ubuntu.com/download/desktop/install-ubuntu-desktop.


Если вы устанавливаете Linux в виртуальную машину, то имеет смысл использовать её самую актуальную версию. Для VirtualBox текущую версию можно скачать здесь (если у вас Windows то идете по ссылке "Windows hosts", если Mac, то по "OS X hosts").


# VIM 

### Вызов VIM

vi | Вызвать новую версию редактора

### Выход

:q! | Без сохранения изменений
:w | Сохранить изменения
:wq | Сохранить и выйти
:w <имя файла> | Сохранить изменения в файл

### Перемещение

h, j, k, l | По символам
w, W | В начало следующего слова
e, E | В конец следующего слова
b, B | В начало предыдущего слова
0, ^, $ | В начало строки, первый непробельный символ, конец строки
gg | В начало файла
G | В конец файла
:21<Enter> | Перейти к строке 21
<Ctrl+D>, <Ctrl+U> | Вниз/вверх на N строчек, где N обычно пол-экрана

### Удаление символов

x | Удалить символ справа от курсора
X | Удалить символ слево от курсора
de | Удалить все символы до конца текущего слова
d$ | Удалить до конца строки
d5w | Удалить пять слов
dd | Удалить строку
d10d | Удалить 10 строк

### Вставка символов

i | Войти в insertion mode
a | Сдвинуть курсор вправо и войти в insertion mode
I или ^i | Перейти на первый непробельный символ и войти в режим вставки
A или $a | Перейти в конец строки и войти ыв режим вставки
o | Вставить пустую строку снизу и редактировать ее
O | Вставить пустую строку сверху и редактировать ее

### Копирование и вставка

y<количество><ход> | Скопировать
yy | Скопировать строку
y11y | Скопировать 11 строчек
p | Вставить перед
P | Вставить после

### Поиск и замена

/<текст> | Искать текст вперед
?<текст> | Искать текст назад
n | Следующее вхождение
N | Предыдущее вхождение
:%s/<что ищем>/<на что заменяем>/<флаги> | g - много замен в строке, с - требовать подтверждение

### Отмена действий

u | Отменить последнее действие
<Ctrl+r> | Вернуть отмененное действие

# Программирование на bash

оболочка shell | интерпретатор команд
sh (Bourne shell) (1977) | 
bash (Bourne again shell) (1989)| Усовершенствованная вариация sh 


which bash | Вывести расположение bash
whish sh | Вывести расположение sh

\#! - шебанг - указывает какую программук надо вызвать если скрипт исполняемы

Команды в скрипте запускаются в новой оболочке - поэтому команды перехода в другую директорию и другие никак не повлияют на оболочку из которой запускался скрипт

Скрипт можно вызвать тремя способома
(скрипт должен быть исполняемымы `chmod +x name.sh`)

1. ./name.sh
2. bash ./name.sh
3. bash name.sh

Команды в bash скрипте называются инструкциями

### Переменные в bash

Имя переменной может содержать буквы, цифры, \_

Если в значении переменной указана строка, в которой есть хотябы один пробел или табуляция, то строку берут в двойные кавычки

path=\~/Docs
$path или $\{path\}

Путь до папок имет вконце '/'

var=value
Одинарные ковычки берут значение как есть: echo "$var" # value
Двойные кавычки подсавляют значение переменных: echo '$var' # $var


### Передача аргументов скрипту

./name.sh arg1 arg2 agr3 ...

$0 | Имя скрипта
$1 ... ${!#} | Первый аргумент ... Последний аргумент
$# | Количество аргументов
$? | Код возврата скрипта

```bash
$ var=test
$ test='Hello, world'
$ echo ${!var}
Hello, world
```

### Код позврата 

./name.sh arg1 arg2 agr3 ...
echo $?

# find

find -iname "FILE*.txt" | не учитывать регистр
find -path "*subdir*/*jpg" | найти указанный путь
find -maxdepth число | искать не более чем на заданное число уровней вниз
find -mindepth число | искать начиная с заданного числа уровней вниз

find -size размер | вывести файлы указанного размера

1. "find <начальный_каталог> -size <размер>" - ищет файлы и каталоги указанного размера: "-size 10M"
2. "find <начальный_каталог> -size -<размер>" - ищет всё, что весит меньше указанного размера: "-size -1000k"
3. "find <начальный_каталог> - size +<размер>" - ищет всё, что больше указанного размера: "-size +10c"

И ещё:

c - Байты;
k - кило;
M - Мега;
G - Гиго;
b - это не байты, а блоки по 512-Байт (по умолчанию).

Как-то так...

С уважением
P.S. Можно также искать по правам доступа к файлу/каталогу "-perm" и типу "-type <тип>" (f - обычный файл; d - каталог). И вообще строить гигантские поисковые выражения;)

# grep

grep -l "строка" файл | Список файлов с этой строкой
grep -L "строка" файл | Список файлов, где этой строки нет
grep -n "строка" файл | Вывести номер строки в файле
grep -m число "строка" файл | Не искать далее после заданного числа вхождений

-A число | Число строк после вхождения
-B число | Число строк до вхождения
-C число | Выводить это число строк вокруг вхождения

-E "шаблон" | Поиск по регулярному выражению

^ - начало строки
$ - конец строки
[a-z] - диапозон
+ - один или более ([a-z]+)
? - ноль или один
* - ноль или более

# sed

Потоковый редактор - читает строчки из stdin и пишет в stdout

cat файл \| sed инструкция

sed инструкция файл

\> файл | Обычное перенаправление
-i, --in-place | Перезаписать входной файл
-r | Регулярные выражения

```
# substitute - замена - s/
# global - g - во всем тексте, а не первое вхождение
sed 's/John/Ivan/g' old.txt > new.txt
sed -r 's/J[a-z]*n/Nick/g' old.txt > new.txt
```
sed -n '2,4p' file.txt | Вывести строки со 2-ой по 4-ую (p - print)
sed '2,4d' file.txt | Удалить строки со 2-ой по 4-ую


sed -n '/[0-9]\{2\}/p' file.txt | Вывести строки с 2 цифрами вподряд
sed '2,/[Rr]ight/d' file.txt | Вывести все строки, кроме со второй до строки содержащей Right или right

A regular expression may be followed by one of several repetition operators:
  ?      The preceding item is optional and matched at most once.
  *      The preceding item will be matched zero or more times.
  +      The preceding item will be matched one or more times.
  {n}    The preceding item is matched exactly n times.
  {n,}   The preceding item is matched n or more times.
  {n,m}  The preceding item is matched at least n times, but not more than m times. 

# gnuplot

Построение графиков

sudo apt-get install gnuplot

Если у вас установлен gnuplot, но он не рисует графики (например, выдает сообщение Terminal type set to 'unknown'), то может помочь установка gnuplot-x11 (например, при помощи sudo apt-get install gnuplot-x11) и его установка в  gnuplot при помощи команды set terminal xterm.

Ctrl + D или exit | Выйти из gnuplot

set title 'название графика'
set xlable 'название оси x'
set ylable 'название оси y'
plot 'файл' using 1:2 title 'название линии'

set key autotitle columnhead | брать название ряда данных из первой строчик файла

set xtics('0' 0.0, '1/4' 0.25, '1/2' 0.5, '1' 1.0) | Задать конкретные надписи на отсечках


set autoscale xy | Автомасштабирование осей x и y
unset autoscale z

```bash
plot './authors.txt' using 1:2, './authors.txt' using 1:4

plot 'файл' using 1:2 smooth csplines with lines lt -1 | Построить сглаженную (smooth) методом csplines линию типа (lt) -1 (черный цвет)

plot 'файл' using 1:2 with point pointsize 1 pointtype 10 lt 1
```


### Потоковый режим работы

```bash
#!/usr/bin/gnuplot -persist
set terminal png enchanced
set output "plot.png"

```

gnuplot --persist имя_скрипта

chmod +x имя_скрипта
./имя_скрипта


-e для передачи значений в скрипт

# Права доступа

Права у файлов
r - просмотр содержимого
w - редактирование
x - запуск

Права у директорий 
r - просмотр содержимого (без метаинформации)
w - создание/удаление/перемещение файлов/поддиректорий внутри директории
x - 1) вход в директорию (с помощью команды cd)
	2) просмотр inode файлов/поддиректорий (получение метоинформации)

inode - метаинформация

1. Дата создания файла
2. Права доступа к файлу

r - read (100, 4)
w - write (010, 2)
x - execute (001, 1)

owner    | group   |  other
---------|---------|---------------
rw-      | rw-     | r--
6        | 6       | 4
110      | 110     | 100

На самом деле и это еще не всё. Существует так называемый sticky bit (атрибут файла или директории), выставление которого меняет описанное выше поведение. Файлы (или директории) с таким атрибутом сможет удалить только их владелец вне зависимости от прав, установленных у директории, в которой эти файлы (или директории) лежат!

## Изменить права доступа

### chmod

`chmod [ugoa] [+-] [rwx] <путь>`

без указания для кого - право добавляется/убирается у всех пользователей
u - user
g - group
o - other
a - all

chmod ug+rw file.txt

`chmod [octal code] <путь>`

chmod 777 file.txt

### chown

`chown new_user:new_group <путь>`
chown zoidberg file.txt
chown :futurama file.txt





# users и who
Команда users выводит логины только тех пользователей, которые сейчас залогинены в системе (т.е. это более узкий аналог команды who, которая выводит больше детальной информации). 

Чтобы увидеть всех пользователей, которые могут залогиниться, нужно смотреть файл /etc/passwd, например, cat /etc/passwd (логины пользователей это первые слова в каждой строчке, но при этом у реальных пользователей, а не системных служб, должно быть третье значение >= 1000 -- это UID, например, bi:x:1000:1000:BI,,,:/home/bi:/bin/zsh -- обычный пользователь bi с UID=1000).

# sudo 

sudo это сокращение от substitute user and do, дословно «подменить пользователя и выполнить». Чаще всего подменяется именно на superuser (root), т.ч. имеет место быть и озвученная в видео "super user do", но это, вообще говоря, не верно!

sudo <действие>
sudo mkdir dir
sudo chmod -r dir | право на чтение пропадет у всех пользователей

# groups 

groups имя_пользователя | узнать группы пользователя

# wc

Посчитать количество

wc -l <filename> вывести количество строк
wc -c <filename> вывести количество байт
wc -m <filename> вывести количество символов
wc -L <filename> вывести длину самой длинной строки
wc -w <filename> вывести количество слов

# diff

Сравнить файлы и директории

diff -r <dir1> <dir2> | Рекурсивно сравнить все файлы с одинаковыми названиями 

-q - Файлы разные или файлы одинаковые

# du

Узнать сколько места файл занимает на диске

`du -h ~/home/bouncer77`
`du -h -s` - Размер текущей директории

# df

Узнать сколько места занято во всей системе

# Использование основных команд

```
mkdir ./{dir1,dir2,dir3}
touch ~/{f1,f2,f3}.txt
ls --sort=size -l ~/
ls --sort=time -l .
```


# Ссылки

http://rus-linux.net/  -- виртуальная энциклопедия ﻿Linux ﻿
﻿http://www.f-notes.info/linux:linux_command -- довольно обширный список полезных команд терминала.
﻿http://ru.najomi.org/_nix -- полезные примеры использования команд терминала
﻿http://forum.ubuntu.ru/ -- форум русскоязычного сообщества Ubuntu.
http://ru.najomi.org/vim -- команды vim
﻿http://lib.ru/LINUXGUIDE/torvalds_jast_for_fun.txt -- книга создателя Linux Линуса Торвальдса "Just for fun".

Ссылка
1. Очень рекомендую курс от Linux Foundation: https://www.edx.org/course/introduction-to-linux-linuxfoundationx-lfs101x-2#.VHrGweqUcU4﻿

Это вторая реинкорнация,  первая была неплохая. Сертификат я брать не рекомендую, лучше купите полноценный курс, который они там активно предлагают. Тем более стоит он ненамного дороже. + тот сертификат престижнее. (Но можно пройти и этот, он все ровно неплох)

2. ﻿Книга http://www.nostarch.com/howlinuxworks2﻿

Недавно вышло второе издание и лучше читать его. Очень крутая книга. Но она предполагает, что начальные знания у вас уже есть.

3. http://en.wikibooks.org/wiki/Bash_Shell_Scripting

Неплохая, короткая и современная книга по Bash.

4. Бесплатная книга о устройстве Linux и командах, которые можно использовать:

http://linuxcommand.org/tlcl.php﻿

Мне кажется лучший вариант после этого курса и пока ждете курс ﻿от Linux Foundation.

5. ﻿http://habrahabr.ru/post/99041/﻿

Неплохая вводная серия статей об устройстве Linux и командах. Тоже можно читать сразу после курса + есть перевод на русский.

Издательство O'Reilly выставило недавно некоторые книги в свободное пользование.

﻿По ссылке http://www.oreilly.com/programming/free/ten-steps-to-linux-survival.csp﻿ можно скачать ﻿книгу "Ten Steps to Linux Survival  / Essentials for Navigating the Bash Jungle". Вроде, хорошая книжка. Но на английском. Все остальные книжки: http://www.oreilly.com/free/reports.html