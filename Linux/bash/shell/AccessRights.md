# Учетные записи

Тип учетной записи | Описание
-------------------|-----------------------------
Суперпользователь  | `root` - полные права на управление компьютером
Администратор      | Ограниченный доступ к системным файлам
Стандартный        | Доступ только к свойе домашней директории

Дальнейшая настройка уровней доступа заключается в установке соответствующих групп и включении в эти шруппы пользователей, а так
же в настройке доступа к папкам и директориям


# Права доступа

Команда             | Назначение
--------------------|-----------------------------
chmod               | изменение прав доступа к объекту
chown               | изменение владельца объекта
chgrp               | изменение группы-владельца объекта
umask               | изменение шаблонов прав доступа для новых файлов и директорий
getfacl/setfacl     | просмотр/изменение списка контроля доступа

Типы прав:

1. Чтение (read)

	+ Чтение содержимого файла

	+ Просмотр перечень имен файлов в директории

2. Запись (write)

	+ Писать в файл и изменять его

3. Выполнение (execute)

	+ Позволяет выполнять файлы 

	+ Переходить к каталогу используя команду cd

Классы пользователей:

1. Пользователь-фладелец файла (u)

2. Группа пользователей (g)

3. Всем остальным пользователям (o)

## Основные права доступа

```bash
# Добавить права на чтение (r) и получение информации о фложенных в папку файлов и директорий (x)
chmod -R +rx ./data

# Лишить всех права записи
chmod a-w file.txt

# Наделить группу и других пользователей правами чтения и исполнения, но не записи
chmod go=rx file.txt
```

## Расширенные права доступа

`getfacl` - просмотр списка контроля доступа для файла или каталога

`setfacl` - установка списка контроля доступа для файла или каталога

### Опции

Ключи:

1. `-m` - добавить записи

2. `-x` - удалить записи

Общий синтаксис каманды:

`setfacl [ключ] {u|g|o|m}:[username|groupname]:{r|-}{w|-}{x|-} <имя_файла|имя_директории>`

### Примеры

```bash
# Вывести список контроля доступа
getfacl dir/

# Дать право группе developers на чтение и запись в файл file.txt
setfacl -m g:developers:rw file.txt

# Дать право пользователю user на чтение файла file.txt
setfacl -m u:user1:r file.txt
```

# umask

Вычитает права доступа из Стандартного Кода Системы (СКС)

СКС   : 666 -> rw- rw- rw-
umask : 135 -> --x -wx r-x
---
res:    643 -> rw- r-- -w-

```bash
# Вывести текущее значение
umask 

# Установить новое значение
umask 770
```

# Группы

 У процесса все полномочия пользователя, от которого он запущен.


Давайте подробнее рассмотрим каждую из групп, чтобы лучше понимать зачем они нужны:

```
daemon - от имени этой группы и пользователя daemon запускаютcя сервисы, которым необходима возможность записи файлов на диск.
sys - группа открывает доступ к исходникам ядра и файлам include сохраненным в системе
sync - позволяет выполнять команду /bin/sync
games - разрешает играм записывать свои файлы настроек и историю в определенную папку
man - позволяет добавлять страницы в директорию /var/cache/man
lp - позволяет использовать устройства параллельных портов
mail - позволяет записывать данные в почтовые ящики /var/mail/
proxy - используется прокси серверами, нет доступа записи файлов на диск
www-data - с этой группой запускается веб-сервер, она дает доступ на запись /var/www, где находятся файлы веб-документов
list - позволяет просматривать сообщения в /var/mail
nogroup - используется для процессов, которые не могут создавать файлов на жестком диске, а только читать, обычно применяется вместе с пользователем nobody.
adm - позволяет читать логи из директории /var/log
tty - все устройства /dev/vca разрешают доступ на чтение и запись пользователям из этой группы
disk - открывает доступ к жестким дискам /dev/sd* /dev/hd*, можно сказать, что это аналог рут доступа.
dialout - полный доступ к серийному порту
cdrom - доступ к CD-ROM
wheel - позволяет запускать утилиту sudo для повышения привилегий
audio - управление аудиодрайвером
src - полный доступ к исходникам в каталоге /usr/src/
shadow - разрешает чтение файла /etc/shadow
utmp - разрешает запись в файлы /var/log/utmp /var/log/wtmp
video - позволяет работать с видеодрайвером
plugdev - позволяет монтировать внешние устройства USB, CD и т д
staff - разрешает запись в папку /usr/local
```

```bash
# Вывести список всех групп
cat /etc/group

# Создать группу
sudo groupadd test
```
## Пользователь

$ usermod опции имя_пользователя

-G - дополнительные группы, в которые нужно добавить пользователя
-g изменить основную группу для пользователя
-R удалить пользователя из группы.


```bash
# Добавить пользователя в группу можно командой usermod:
sudo usermod -aG имя_группы имя_пользователя

# Установить пользователю группы (остальные группы будут сброшены)
sudo usermod -G имя_группы1,имя_группы2 имя_пользователя
```
